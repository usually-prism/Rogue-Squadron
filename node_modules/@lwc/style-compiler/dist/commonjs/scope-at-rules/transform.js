"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const selectors_scoping_1 = require("../utils/selectors-scoping");
function process(root) {
    const knownNames = new Set();
    root.walkAtRules((atRule) => {
        if (atRule.name === 'keyframes') {
            const { params } = atRule;
            knownNames.add(params);
            atRule.params = `${params}-${selectors_scoping_1.SHADOW_ATTRIBUTE}`;
        }
    });
    root.walkRules((rule) => {
        rule.walkDecls((decl) => {
            if (decl.prop === 'animation') {
                // Use a simple heuristic of breaking up the tokens by whitespace. We could use
                // a dedicated animation prop parser (e.g.
                // https://github.com/hookhookun/parse-animation-shorthand) but it's
                // probably overkill.
                const tokens = decl.value
                    .trim()
                    .split(/\s+/g)
                    .map((token) => knownNames.has(token) ? `${token}-${selectors_scoping_1.SHADOW_ATTRIBUTE}` : token);
                decl.value = tokens.join(' ');
            }
            else if (decl.prop === 'animation-name') {
                if (knownNames.has(decl.value)) {
                    decl.value = `${decl.value}-${selectors_scoping_1.SHADOW_ATTRIBUTE}`;
                }
            }
        });
    });
}
exports.default = process;
//# sourceMappingURL=transform.js.map